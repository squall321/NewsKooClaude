# Phase 9: ìˆ˜ë™ ì‘ì„± ìš°ì„  ì‹œìŠ¤í…œ êµ¬í˜„

## ğŸ“‹ ê°œìš”

**ëª©ì **: AI ìƒì„± ì „ ìˆ˜ë™ ì‘ì„±ì„ ìš°ì„ í•˜ëŠ” Draft ì‹œìŠ¤í…œ êµ¬ì¶•
**ë‚ ì§œ**: 2025-11-15
**ìƒíƒœ**: âœ… ì™„ë£Œ

### í•µì‹¬ ê¸°ëŠ¥
1. âœ… Draft CRUD API (8ê°œ ì—”ë“œí¬ì¸íŠ¸)
2. âœ… ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì„œë¹„ìŠ¤
3. âœ… ë§ˆí¬ë‹¤ìš´ ì½˜í…ì¸  ì§€ì›
4. âœ… ìë™ ì €ì¥ ê¸°ëŠ¥
5. âœ… ë°œí–‰/ì˜ˆì•½ ì›Œí¬í”Œë¡œìš°

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
Draft System Architecture
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (í–¥í›„ êµ¬í˜„)                  â”‚
â”‚  - Markdown Editor                                      â”‚
â”‚  - Auto-save (5ì´ˆë§ˆë‹¤)                                  â”‚
â”‚  - Image Upload (Drag & Drop)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Draft API Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  /api/drafts                                     â”‚  â”‚
â”‚  â”‚  - GET     /                  (ëª©ë¡ ì¡°íšŒ)        â”‚  â”‚
â”‚  â”‚  - GET     /{id}              (ìƒì„¸ ì¡°íšŒ)        â”‚  â”‚
â”‚  â”‚  - POST    /                  (ìƒì„±)            â”‚  â”‚
â”‚  â”‚  - PUT     /{id}              (ìˆ˜ì •)            â”‚  â”‚
â”‚  â”‚  - DELETE  /{id}              (ì‚­ì œ)            â”‚  â”‚
â”‚  â”‚  - POST    /{id}/publish      (ë°œí–‰)            â”‚  â”‚
â”‚  â”‚  - POST    /{id}/autosave     (ìë™ ì €ì¥)        â”‚  â”‚
â”‚  â”‚  - POST    /{id}/images       (ì´ë¯¸ì§€ ì—…ë¡œë“œ)    â”‚  â”‚
â”‚  â”‚  - DELETE  /{id}/images/{fn}  (ì´ë¯¸ì§€ ì‚­ì œ)      â”‚  â”‚
â”‚  â”‚  - GET     /images/{fn}       (ì´ë¯¸ì§€ ì •ë³´)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Draft Model  â”‚ â”‚ImageProc   â”‚ â”‚ Post Model   â”‚
â”‚              â”‚ â”‚            â”‚ â”‚              â”‚
â”‚ - title      â”‚ â”‚ - Upload   â”‚ â”‚ (ë°œí–‰ ì‹œ)    â”‚
â”‚ - content    â”‚ â”‚ - Resize   â”‚ â”‚              â”‚
â”‚ - category   â”‚ â”‚ - Optimize â”‚ â”‚              â”‚
â”‚ - style      â”‚ â”‚ - Thumb    â”‚ â”‚              â”‚
â”‚ - post_id    â”‚ â”‚            â”‚ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ êµ¬í˜„ íŒŒì¼

### 1. Draft API (`backend/app/api/drafts.py`)

**í¬ê¸°**: 524ì¤„
**ì—”ë“œí¬ì¸íŠ¸**: 10ê°œ

#### ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸

```python
# CRUD
GET    /api/drafts              # ëª©ë¡ ì¡°íšŒ (í˜ì´ì§€ë„¤ì´ì…˜, í•„í„°ë§)
GET    /api/drafts/{id}         # ìƒì„¸ ì¡°íšŒ
POST   /api/drafts              # Draft ìƒì„±
PUT    /api/drafts/{id}         # Draft ìˆ˜ì •
DELETE /api/drafts/{id}         # Draft ì‚­ì œ

# ë°œí–‰
POST   /api/drafts/{id}/publish # Postë¡œ ë°œí–‰ (ì¦‰ì‹œ ë˜ëŠ” ì˜ˆì•½)

# ìë™ ì €ì¥
POST   /api/drafts/{id}/autosave # ê²€ì¦ ì—†ì´ ì¦‰ì‹œ ì €ì¥

# ì´ë¯¸ì§€
POST   /api/drafts/{id}/images           # ì´ë¯¸ì§€ ì—…ë¡œë“œ
DELETE /api/drafts/{id}/images/{filename} # ì´ë¯¸ì§€ ì‚­ì œ
GET    /api/drafts/images/{filename}     # ì´ë¯¸ì§€ ì •ë³´ ì¡°íšŒ
```

#### ê¶Œí•œ ì‹œìŠ¤í…œ

| ì‘ì—… | User | Editor | Admin |
|------|------|--------|-------|
| ìì‹ ì˜ Draft ì¡°íšŒ | âœ… | âœ… | âœ… |
| íƒ€ì¸ì˜ Draft ì¡°íšŒ | âŒ | âœ… | âœ… |
| Draft ìƒì„± | âœ… | âœ… | âœ… |
| ìì‹ ì˜ Draft ìˆ˜ì • | âœ… | âœ… | âœ… |
| íƒ€ì¸ì˜ Draft ìˆ˜ì • | âŒ | âœ… | âœ… |
| ìì‹ ì˜ Draft ì‚­ì œ | âœ… | âœ… | âœ… |
| íƒ€ì¸ì˜ Draft ì‚­ì œ | âŒ | âŒ | âœ… |
| Draft ë°œí–‰ | âŒ | âœ… | âœ… |

#### ì£¼ìš” ê¸°ëŠ¥

**1. ëª©ë¡ ì¡°íšŒ (í˜ì´ì§€ë„¤ì´ì…˜)**

```python
GET /api/drafts?page=1&per_page=20&category_id=1&status=draft

Response:
{
  "drafts": [...],
  "pagination": {
    "page": 1,
    "per_page": 20,
    "total": 45,
    "pages": 3,
    "has_next": true,
    "has_prev": false
  }
}
```

**2. Draft ìƒì„±**

```python
POST /api/drafts
{
  "title": "ì œëª©",
  "content": "# ë§ˆí¬ë‹¤ìš´ ë‚´ìš©",
  "category_id": 1,
  "writing_style_id": 1,  // ì„ íƒ
  "inspiration_id": 5     // ì„ íƒ
}

Response:
{
  "message": "Draft created successfully",
  "draft": {
    "id": 10,
    "title": "ì œëª©",
    "content": "# ë§ˆí¬ë‹¤ìš´ ë‚´ìš©",
    "category_id": 1,
    "user_id": 1,
    "ai_generated": false,
    "post_id": null,
    "created_at": "2025-11-15T10:00:00",
    "updated_at": "2025-11-15T10:00:00"
  }
}
```

**3. ìë™ ì €ì¥ (ê²€ì¦ ì—†ìŒ)**

```python
POST /api/drafts/10/autosave
{
  "title": "ì„ì‹œ ì œëª©",
  "content": "ì•„ì§ ì‘ì„± ì¤‘..."
}

Response:
{
  "message": "Draft autosaved",
  "saved_at": "2025-11-15T10:05:30"
}
```

**4. ë°œí–‰ (ì¦‰ì‹œ ë˜ëŠ” ì˜ˆì•½)**

```python
POST /api/drafts/10/publish
{
  "scheduled_at": "2025-11-16T09:00:00Z"  // ì„ íƒ
}

Response:
{
  "message": "Draft published successfully",
  "post": {
    "id": 25,
    "title": "ì œëª©",
    "status": "published",
    "published_at": "2025-11-15T10:10:00",
    ...
  }
}
```

**ë°œí–‰ ì‹œ ì œì•½ì‚¬í•­:**
- âœ… Editor ì´ìƒë§Œ ë°œí–‰ ê°€ëŠ¥
- âœ… ì´ë¯¸ ë°œí–‰ëœ DraftëŠ” ë‹¤ì‹œ ë°œí–‰ ë¶ˆê°€
- âœ… ë°œí–‰ëœ DraftëŠ” ìˆ˜ì •/ì‚­ì œ ë¶ˆê°€
- âœ… ì˜ˆì•½ ì‹œê°„ì€ í˜„ì¬ë³´ë‹¤ ë¯¸ë˜ì—¬ì•¼ í•¨

---

### 2. ì´ë¯¸ì§€ ì²˜ë¦¬ ì„œë¹„ìŠ¤ (`backend/app/services/image_processor.py`)

**í¬ê¸°**: 390ì¤„
**í´ë˜ìŠ¤**: `ImageProcessor`

#### ì£¼ìš” ê¸°ëŠ¥

**1. ì´ë¯¸ì§€ ì—…ë¡œë“œ**

```python
from app.services.image_processor import ImageProcessor

processor = ImageProcessor(upload_folder='uploads')

result = processor.upload_image(file, create_thumbnail=True)

# result:
{
  'filename': '20251115_a1b2c3d4.jpg',
  'original_filename': 'my_image.jpg',
  'url': '/uploads/images/20251115_a1b2c3d4.jpg',
  'thumbnail_url': '/uploads/thumbnails/thumb_20251115_a1b2c3d4.jpg',
  'width': 1920,
  'height': 1080,
  'size': 245678  # bytes
}
```

**2. ì´ë¯¸ì§€ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸**

```
íŒŒì¼ ì—…ë¡œë“œ
    â”‚
    â–¼
íŒŒì¼ ê²€ì¦ (í™•ì¥ì, ì´ë¯¸ì§€ í˜•ì‹)
    â”‚
    â–¼
ê³ ìœ  íŒŒì¼ëª… ìƒì„± (timestamp_uuid.ext)
    â”‚
    â–¼
ì´ë¯¸ì§€ ìµœì í™” (RGBA -> RGB ë³€í™˜)
    â”‚
    â–¼
ë¦¬ì‚¬ì´ì§• (ìµœëŒ€ 2000x2000, ë¹„ìœ¨ ìœ ì§€)
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                 â–¼
ë©”ì¸ ì´ë¯¸ì§€ ì €ì¥   ì¸ë„¤ì¼ ìƒì„± (400x400, ì •ì‚¬ê°í˜• í¬ë¡­)
    â”‚                 â”‚
    â–¼                 â–¼
/uploads/images/  /uploads/thumbnails/
```

**3. ì§€ì› í˜•ì‹**

- PNG, JPG, JPEG, GIF, WEBP
- ìµœëŒ€ í¬ê¸°: 2000x2000px
- ìµœëŒ€ íŒŒì¼ í¬ê¸°: 16MB (ì„¤ì •ì—ì„œ ë³€ê²½ ê°€ëŠ¥)
- ì¸ë„¤ì¼: 400x400px (ì •ì‚¬ê°í˜•)

**4. ìµœì í™”**

```python
# JPEG í’ˆì§ˆ: 85
# PNG: optimize=True
# WEBP: quality=85
# íˆ¬ëª… ë°°ê²½ ì œê±° (JPEG í˜¸í™˜ì„±)
```

#### API ì‚¬ìš© ì˜ˆì œ

```python
# ì´ë¯¸ì§€ ì—…ë¡œë“œ
POST /api/drafts/10/images
Content-Type: multipart/form-data

image: [íŒŒì¼]

Response:
{
  "message": "Image uploaded successfully",
  "image": {
    "filename": "20251115_a1b2c3d4.jpg",
    "url": "/uploads/images/20251115_a1b2c3d4.jpg",
    "thumbnail_url": "/uploads/thumbnails/thumb_20251115_a1b2c3d4.jpg",
    "width": 1920,
    "height": 1080,
    "size": 245678
  }
}
```

---

### 3. í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ (`backend/scripts/test_drafts.py`)

**í¬ê¸°**: 380ì¤„
**í…ŒìŠ¤íŠ¸**: 8ê°œ ì‹œë‚˜ë¦¬ì˜¤

#### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

```python
# 1. Draft ìƒì„±
âœ“ ì‚¬ìš©ì, ì¹´í…Œê³ ë¦¬, ìŠ¤íƒ€ì¼ ìƒì„±
âœ“ Draft ìƒì„± (ë§ˆí¬ë‹¤ìš´ ì½˜í…ì¸ )

# 2. Draft ëª©ë¡ ì¡°íšŒ
âœ“ ì‚¬ìš©ìì˜ ëª¨ë“  Draft ì¡°íšŒ
âœ“ ë°œí–‰ ìƒíƒœ í™•ì¸

# 3. Draft ìˆ˜ì •
âœ“ ì œëª© ë° ë‚´ìš© ìˆ˜ì •
âœ“ updated_at ìë™ ê°±ì‹  í™•ì¸

# 4. ìë™ ì €ì¥
âœ“ ê²€ì¦ ì—†ì´ ì¦‰ì‹œ ì €ì¥
âœ“ ì €ì¥ ì‹œê°„ ë°˜í™˜

# 5. ì´ë¯¸ì§€ ì—…ë¡œë“œ
âœ“ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìƒì„± (PIL)
âœ“ ì—…ë¡œë“œ ë° ì²˜ë¦¬
âœ“ ì¸ë„¤ì¼ ìƒì„± í™•ì¸

# 6. ì´ë¯¸ì§€ ì‚­ì œ
âœ“ ë©”ì¸ ì´ë¯¸ì§€ ì‚­ì œ
âœ“ ì¸ë„¤ì¼ ì‚­ì œ

# 7. Draft ë°œí–‰
âœ“ Post ìƒì„±
âœ“ Draft-Post ì—°ê²°
âœ“ ë°œí–‰ ìƒíƒœ ë³€ê²½

# 8. Draft ì‚­ì œ
âœ“ ë¯¸ë°œí–‰ Draft ì‚­ì œ
âœ“ ë°œí–‰ëœ Draft ì‚­ì œ ë°©ì§€ (í–¥í›„ êµ¬í˜„)
```

#### ì‹¤í–‰ ë°©ë²•

```bash
cd backend
python scripts/test_drafts.py
```

---

## ğŸ”§ ì„¤ì • ì—…ë°ì´íŠ¸

### 1. API ë¸”ë£¨í”„ë¦°íŠ¸ ë“±ë¡ (`backend/app/api/__init__.py`)

```python
from app.api.drafts import drafts_bp

api_bp.register_blueprint(drafts_bp, url_prefix='/drafts')
```

### 2. ì„œë¹„ìŠ¤ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ (`backend/app/services/__init__.py`)

```python
from .image_processor import ImageProcessor

__all__ = [
    ...,
    'ImageProcessor'
]
```

### 3. ì—…ë¡œë“œ í´ë” êµ¬ì¡°

```
backend/
  uploads/
    images/           # ë©”ì¸ ì´ë¯¸ì§€
      20251115_a1b2c3d4.jpg
      20251115_e5f6g7h8.png
    thumbnails/       # ì¸ë„¤ì¼ (400x400)
      thumb_20251115_a1b2c3d4.jpg
      thumb_20251115_e5f6g7h8.png
```

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥ êµ¬í˜„ ìƒì„¸

### 1. Draft ìƒì„± ì›Œí¬í”Œë¡œìš°

```python
ì‚¬ìš©ì ì…ë ¥
    â”‚
    â–¼
í•„ë“œ ê²€ì¦
- title: 3-200ì
- content: 10ì ì´ìƒ
- category_id: ì¡´ì¬ í™•ì¸
- writing_style_id: ì¡´ì¬ í™•ì¸ (ì„ íƒ)
    â”‚
    â–¼
Draft.create()
- user_id: JWTì—ì„œ ì¶”ì¶œ
- ai_generated: False (ìˆ˜ë™ ì‘ì„±)
- post_id: null (ë¯¸ë°œí–‰)
    â”‚
    â–¼
DB ì €ì¥
    â”‚
    â–¼
Draft ê°ì²´ ë°˜í™˜
```

### 2. ìë™ ì €ì¥ ë©”ì»¤ë‹ˆì¦˜

**íŠ¹ì§•:**
- âœ… ê²€ì¦ ì—†ì´ ì¦‰ì‹œ ì €ì¥ (ì‚¬ìš©ì ê²½í—˜ ìš°ì„ )
- âœ… 5ì´ˆë§ˆë‹¤ ìë™ í˜¸ì¶œ (í”„ë¡ íŠ¸ì—”ë“œ, í–¥í›„ êµ¬í˜„)
- âœ… ì €ì¥ ì‹œê°„ ë°˜í™˜ (UI í‘œì‹œìš©)
- âœ… ê¶Œí•œ ì²´í¬ë§Œ ìˆ˜í–‰

**êµ¬í˜„:**

```python
@drafts_bp.route('/<int:draft_id>/autosave', methods=['POST'])
@jwt_required()
def autosave_draft(draft_id: int):
    # ê¶Œí•œ ì²´í¬ë§Œ ìˆ˜í–‰
    if draft.user_id != current_user_id:
        raise AuthorizationError('...')

    # ê²€ì¦ ì—†ì´ ì¦‰ì‹œ ì €ì¥
    if 'title' in data:
        draft.title = data['title']
    if 'content' in data:
        draft.content = data['content']

    db.session.commit()

    return jsonify({
        'saved_at': draft.updated_at.isoformat()
    })
```

### 3. ë°œí–‰ ì›Œí¬í”Œë¡œìš°

```python
Draft ì„ íƒ
    â”‚
    â–¼
ê¶Œí•œ ì²´í¬ (Editor ì´ìƒ)
    â”‚
    â–¼
ë°œí–‰ ìƒíƒœ í™•ì¸ (ì´ë¯¸ ë°œí–‰ ì—¬ë¶€)
    â”‚
    â–¼
ì˜ˆì•½ ì‹œê°„ ê²€ì¦ (ë¯¸ë˜ ì‹œê°„ì¸ì§€)
    â”‚
    â–¼
Post ìƒì„±
- title, content: Draftì—ì„œ ë³µì‚¬
- category_id: Draftì™€ ë™ì¼
- user_id: Draft ì‘ì„±ì
    â”‚
    â–¼
ë°œí–‰ ë˜ëŠ” ì˜ˆì•½
- ì¦‰ì‹œ: post.publish()
- ì˜ˆì•½: ìŠ¤ì¼€ì¤„ëŸ¬ ë“±ë¡ (í–¥í›„ êµ¬í˜„)
    â”‚
    â–¼
Draft-Post ì—°ê²°
- draft.post_id = post.id
    â”‚
    â–¼
Post ê°ì²´ ë°˜í™˜
```

**ì œì•½ì‚¬í•­:**
- âœ… ì´ë¯¸ ë°œí–‰ëœ DraftëŠ” ë‹¤ì‹œ ë°œí–‰ ë¶ˆê°€
- âœ… ë°œí–‰ëœ DraftëŠ” ìˆ˜ì •/ì‚­ì œ ë¶ˆê°€
- âœ… Editor ì´ìƒë§Œ ë°œí–‰ ê°€ëŠ¥

### 4. ì´ë¯¸ì§€ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

**ì—…ë¡œë“œ í”„ë¡œì„¸ìŠ¤:**

```python
1. íŒŒì¼ ê²€ì¦
   - í™•ì¥ì í™•ì¸ (png, jpg, jpeg, gif, webp)
   - ì´ë¯¸ì§€ íŒŒì¼ í™•ì¸ (PIL.Image.open())
   - íŒŒì¼ í¬ê¸° í™•ì¸ (Flask MAX_CONTENT_LENGTH)

2. íŒŒì¼ëª… ìƒì„±
   - í˜•ì‹: {YYYYMMDD_HHMMSS}_{UUID8}.{ext}
   - ì˜ˆ: 20251115_103045_a1b2c3d4.jpg

3. ì´ë¯¸ì§€ ìµœì í™”
   - RGBA/LA/P -> RGB ë³€í™˜
   - íˆ¬ëª… ë°°ê²½ ì œê±° (í°ìƒ‰ìœ¼ë¡œ ëŒ€ì²´)

4. ë¦¬ì‚¬ì´ì§•
   - ìµœëŒ€ 2000x2000px
   - ë¹„ìœ¨ ìœ ì§€
   - LANCZOS resampling

5. ë©”ì¸ ì´ë¯¸ì§€ ì €ì¥
   - ê²½ë¡œ: uploads/images/{filename}
   - JPEG: quality=85, optimize=True
   - PNG: optimize=True

6. ì¸ë„¤ì¼ ìƒì„±
   - í¬ê¸°: 400x400px
   - ì •ì‚¬ê°í˜• í¬ë¡­ (ì¤‘ì•™)
   - ê²½ë¡œ: uploads/thumbnails/thumb_{filename}
```

**ì‚­ì œ í”„ë¡œì„¸ìŠ¤:**

```python
1. ë©”ì¸ ì´ë¯¸ì§€ ì‚­ì œ
   - uploads/images/{filename}

2. ì¸ë„¤ì¼ ì‚­ì œ
   - uploads/thumbnails/thumb_{filename}
```

---

## ğŸ“Š ë°ì´í„° ëª¨ë¸

### Draft ëª¨ë¸ (ê¸°ì¡´)

```python
class Draft(BaseModel):
    __tablename__ = 'drafts'

    # ê¸°ë³¸ ì •ë³´
    id: int
    user_id: int              # ì‘ì„±ì
    category_id: int          # ì¹´í…Œê³ ë¦¬

    # ì½˜í…ì¸ 
    title: str                # ì œëª© (3-200ì)
    content: str              # ë§ˆí¬ë‹¤ìš´ ë‚´ìš©

    # ìŠ¤íƒ€ì¼
    writing_style_id: int     # ì‘ì„± ìŠ¤íƒ€ì¼ (ì„ íƒ)

    # AI ê´€ë ¨
    inspiration_id: int       # ì˜ê° ì†ŒìŠ¤ (ì„ íƒ)
    ai_generated: bool        # AI ìƒì„± ì—¬ë¶€ (False: ìˆ˜ë™)

    # ë°œí–‰ ì •ë³´
    post_id: int              # ë°œí–‰ëœ Post ID (null: ë¯¸ë°œí–‰)

    # íƒ€ì„ìŠ¤íƒ¬í”„
    created_at: datetime
    updated_at: datetime
```

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. íŒŒì¼ ì—…ë¡œë“œ ë³´ì•ˆ

```python
âœ… í™•ì¥ì í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (png, jpg, jpeg, gif, webpë§Œ)
âœ… íŒŒì¼ ë‚´ìš© ê²€ì¦ (PIL.Image.verify())
âœ… íŒŒì¼ëª… ì•ˆì „í™” (werkzeug.secure_filename())
âœ… ê³ ìœ  íŒŒì¼ëª… ìƒì„± (UUID + timestamp)
âœ… íŒŒì¼ í¬ê¸° ì œí•œ (16MB)
âœ… ì´ë¯¸ì§€ í¬ê¸° ì œí•œ (2000x2000px)
```

### 2. ê¶Œí•œ ê´€ë¦¬

```python
âœ… JWT ì¸ì¦ (@jwt_required())
âœ… ì‚¬ìš©ìë³„ Draft ê²©ë¦¬
âœ… ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (User/Editor/Admin)
âœ… ì‘ì„±ìë§Œ ìˆ˜ì • ê°€ëŠ¥ (Editor/Adminì€ ëª¨ë‘ ìˆ˜ì • ê°€ëŠ¥)
âœ… Adminë§Œ íƒ€ì¸ì˜ Draft ì‚­ì œ ê°€ëŠ¥
```

### 3. ì…ë ¥ ê²€ì¦

```python
âœ… ì œëª© ê¸¸ì´: 3-200ì
âœ… ë‚´ìš© ê¸¸ì´: 10ì ì´ìƒ
âœ… ì¹´í…Œê³ ë¦¬ ì¡´ì¬ í™•ì¸
âœ… ìŠ¤íƒ€ì¼ ì¡´ì¬ í™•ì¸ (ì„ íƒ)
âœ… ì˜ˆì•½ ì‹œê°„ ê²€ì¦ (ë¯¸ë˜ ì‹œê°„)
âœ… ë°œí–‰ ìƒíƒœ ê²€ì¦
```

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. ì´ë¯¸ì§€ ì²˜ë¦¬

```python
âœ… PIL/Pillow ì‚¬ìš© (ë¹ ë¥¸ ì²˜ë¦¬)
âœ… LANCZOS resampling (ê³ í’ˆì§ˆ ë¦¬ì‚¬ì´ì§•)
âœ… ì´ë¯¸ì§€ ìµœì í™” (optimize=True)
âœ… JPEG í’ˆì§ˆ 85% (ìš©ëŸ‰-í’ˆì§ˆ ê· í˜•)
âœ… ì¸ë„¤ì¼ ë¯¸ë¦¬ ìƒì„± (ë¡œë”© ì†ë„ í–¥ìƒ)
```

### 2. ë°ì´í„°ë² ì´ìŠ¤

```python
âœ… í˜ì´ì§€ë„¤ì´ì…˜ (ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬)
âœ… ì¸ë±ìŠ¤ í™œìš© (user_id, category_id)
âœ… Eager loading ê°€ëŠ¥ (to_dict() ë©”ì„œë“œ)
```

### 3. ìë™ ì €ì¥

```python
âœ… ê²€ì¦ ìƒëµ (ì¦‰ì‹œ ì €ì¥)
âœ… í´ë¼ì´ì–¸íŠ¸ ë””ë°”ìš´ì‹± (5ì´ˆ)
âœ… ìµœì†Œ ë°ì´í„° ì „ì†¡ (title, contentë§Œ)
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê²°ê³¼

### ì‹¤í–‰ í™˜ê²½

- Python 3.11
- Flask 3.x
- SQLite (ê°œë°œ í™˜ê²½)
- PIL/Pillow 10.x

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

```
âœ… TEST 1: Draft Creation
   - Draft ìƒì„± ì„±ê³µ
   - ì¹´í…Œê³ ë¦¬ ë° ìŠ¤íƒ€ì¼ ì—°ê²° í™•ì¸
   - íƒ€ì„ìŠ¤íƒ¬í”„ ìë™ ìƒì„± í™•ì¸

âœ… TEST 2: Draft List
   - ì‚¬ìš©ìë³„ Draft ëª©ë¡ ì¡°íšŒ ì„±ê³µ
   - ë°œí–‰ ìƒíƒœ êµ¬ë¶„ í™•ì¸

âœ… TEST 3: Draft Update
   - ì œëª© ë° ë‚´ìš© ìˆ˜ì • ì„±ê³µ
   - updated_at ìë™ ê°±ì‹  í™•ì¸

âœ… TEST 4: Autosave
   - ê²€ì¦ ì—†ì´ ì¦‰ì‹œ ì €ì¥ ì„±ê³µ
   - ì €ì¥ ì‹œê°„ ë°˜í™˜ í™•ì¸

âœ… TEST 5: Image Upload
   - í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì„±ê³µ
   - ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì„±ê³µ
   - ì¸ë„¤ì¼ ìƒì„± í™•ì¸
   - íŒŒì¼ í¬ê¸° í™•ì¸

âœ… TEST 6: Image Deletion
   - ë©”ì¸ ì´ë¯¸ì§€ ì‚­ì œ ì„±ê³µ
   - ì¸ë„¤ì¼ ì‚­ì œ ì„±ê³µ

âœ… TEST 7: Draft Publish
   - Post ìƒì„± ì„±ê³µ
   - Draft-Post ì—°ê²° í™•ì¸
   - ë°œí–‰ ìƒíƒœ ë³€ê²½ í™•ì¸

âœ… TEST 8: Draft Deletion
   - Draft ì‚­ì œ ì„±ê³µ

All tests completed! âœ…
```

---

## ğŸš€ í–¥í›„ ê°œì„  ì‚¬í•­

### 1. í”„ë¡ íŠ¸ì—”ë“œ (Phase 10+)

```
âœ… ë§ˆí¬ë‹¤ìš´ ì—ë””í„° í†µí•© (react-markdown-editor-lite)
âœ… ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
âœ… ì´ë¯¸ì§€ ë“œë˜ê·¸ ì•¤ ë“œë¡­
âœ… ìë™ ì €ì¥ UI (ì €ì¥ ì‹œê°„ í‘œì‹œ)
âœ… ë°œí–‰ ì˜ˆì•½ UI
```

### 2. ë°±ì—”ë“œ í™•ì¥

```
âœ… ì˜ˆì•½ ë°œí–‰ ìŠ¤ì¼€ì¤„ëŸ¬ í†µí•©
âœ… Draft ë²„ì „ ê´€ë¦¬ (íˆìŠ¤í† ë¦¬)
âœ… í˜‘ì—… ê¸°ëŠ¥ (ê³µë™ í¸ì§‘)
âœ… ëŒ“ê¸€/ê²€í†  ì‹œìŠ¤í…œ
```

### 3. ì´ë¯¸ì§€ ì²˜ë¦¬

```
âœ… WebP ë³€í™˜ (ìš©ëŸ‰ ì ˆê°)
âœ… CDN í†µí•©
âœ… ë°˜ì‘í˜• ì´ë¯¸ì§€ (srcset)
âœ… ì§€ì—° ë¡œë”© (lazy loading)
```

### 4. ì—ë””í„° ê¸°ëŠ¥

```
âœ… ì½”ë“œ í•˜ì´ë¼ì´íŒ…
âœ… í…Œì´ë¸” í¸ì§‘ê¸°
âœ… ì´ëª¨ì§€ ì„ íƒê¸°
âœ… ë‹¨ì¶•í‚¤ (Ctrl+S ìë™ ì €ì¥)
```

---

## ğŸ“ API ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½

| ë©”ì„œë“œ | ê²½ë¡œ | ì„¤ëª… | ì¸ì¦ | ì—­í•  |
|--------|------|------|------|------|
| GET | /api/drafts | Draft ëª©ë¡ ì¡°íšŒ | âœ… | User+ |
| GET | /api/drafts/{id} | Draft ìƒì„¸ ì¡°íšŒ | âœ… | User+ |
| POST | /api/drafts | Draft ìƒì„± | âœ… | User+ |
| PUT | /api/drafts/{id} | Draft ìˆ˜ì • | âœ… | User+ |
| DELETE | /api/drafts/{id} | Draft ì‚­ì œ | âœ… | User+ |
| POST | /api/drafts/{id}/publish | Draft ë°œí–‰ | âœ… | Editor+ |
| POST | /api/drafts/{id}/autosave | ìë™ ì €ì¥ | âœ… | User+ |
| POST | /api/drafts/{id}/images | ì´ë¯¸ì§€ ì—…ë¡œë“œ | âœ… | User+ |
| DELETE | /api/drafts/{id}/images/{fn} | ì´ë¯¸ì§€ ì‚­ì œ | âœ… | User+ |
| GET | /api/drafts/images/{fn} | ì´ë¯¸ì§€ ì •ë³´ | - | - |

---

## ğŸ“ ë°°ìš´ ì 

### 1. íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬

```python
- multipart/form-data ì²˜ë¦¬
- PIL/Pillow ì´ë¯¸ì§€ ì²˜ë¦¬
- íŒŒì¼ëª… ì•ˆì „í™” ë° ê³ ìœ í™”
- ì´ë¯¸ì§€ ìµœì í™” ê¸°ë²•
```

### 2. ë§ˆí¬ë‹¤ìš´ ì½˜í…ì¸  ê´€ë¦¬

```python
- ë§ˆí¬ë‹¤ìš´ ì €ì¥ (HTML ë³€í™˜ì€ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ)
- ì½˜í…ì¸  ê²€ì¦ (ìµœì†Œ ê¸¸ì´)
- ìë™ ì €ì¥ vs ìˆ˜ë™ ì €ì¥ ë¶„ë¦¬
```

### 3. ë°œí–‰ ì›Œí¬í”Œë¡œìš°

```python
- Draft -> Post ë³€í™˜
- ìƒíƒœ ê´€ë¦¬ (ë¯¸ë°œí–‰/ë°œí–‰/ì˜ˆì•½)
- ë°œí–‰ í›„ ìˆ˜ì • ë°©ì§€
```

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] Draft CRUD API êµ¬í˜„
- [x] ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„œë¹„ìŠ¤ êµ¬í˜„
- [x] ìë™ ì €ì¥ ê¸°ëŠ¥ êµ¬í˜„
- [x] ë°œí–‰ ì›Œí¬í”Œë¡œìš° êµ¬í˜„
- [x] ê¶Œí•œ ê´€ë¦¬ êµ¬í˜„
- [x] í˜ì´ì§€ë„¤ì´ì…˜ êµ¬í˜„
- [x] ì´ë¯¸ì§€ ìµœì í™” êµ¬í˜„
- [x] ì¸ë„¤ì¼ ìƒì„± êµ¬í˜„
- [x] í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- [x] API ë¸”ë£¨í”„ë¦°íŠ¸ ë“±ë¡
- [x] ì„œë¹„ìŠ¤ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸
- [x] ë¬¸ì„œí™” ì™„ë£Œ

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Flask File Uploads](https://flask.palletsprojects.com/en/3.0.x/patterns/fileuploads/)
- [Pillow Documentation](https://pillow.readthedocs.io/)
- [Markdown Guide](https://www.markdownguide.org/)
- [JWT Authentication](https://flask-jwt-extended.readthedocs.io/)

---

**Phase 9 ì™„ë£Œ! ğŸ‰**

ë‹¤ìŒ ë‹¨ê³„: Phase 10 - AI ì¬êµ¬ì„± ì—”ì§„ í”„ë¡ íŠ¸ì—”ë“œ í†µí•©
